kind: pipeline
name: default

steps:
- name: install
  image: elixir:1.8-alpine
  volumes:
  - name: mix
    path: /root/.mix
  commands:
  - mix local.rebar --force
  - mix local.hex --force
  - mix deps.get

- name: test
  image: elixir:1.8-alpine
  volumes:
  - name: mix
    path: /root/.mix
  commands:
  - mix test

# - name: publish
#   image: plugins/github-release
#   settings:
#     api_key:
#       from_secret: GITHUB_API_KEY
#     files: bin/dotfiler
#   when:
#     event: tag

volumes:
- name: mix
  temp: {}
